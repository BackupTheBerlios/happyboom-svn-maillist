<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Happyboom-svn] r241 - in haypo/hachoir: . plugins
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/happyboom-svn/2005-October/index.html" >
   <LINK REL="made" HREF="mailto:happyboom-svn%40lists.berlios.de?Subject=Re%3A%20%5BHappyboom-svn%5D%20r241%20-%20in%20haypo/hachoir%3A%20.%20plugins&In-Reply-To=%3C200510311640.j9VGeQQJ021232%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000147.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Happyboom-svn] r241 - in haypo/hachoir: . plugins</H1>
    <B>Victor STINNER at BerliOS</B> 
    <A HREF="mailto:happyboom-svn%40lists.berlios.de?Subject=Re%3A%20%5BHappyboom-svn%5D%20r241%20-%20in%20haypo/hachoir%3A%20.%20plugins&In-Reply-To=%3C200510311640.j9VGeQQJ021232%40sheep.berlios.de%3E"
       TITLE="[Happyboom-svn] r241 - in haypo/hachoir: . plugins">haypo at berlios.de
       </A><BR>
    <I>Mon Oct 31 17:40:26 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000147.html">[Happyboom-svn] r240 - haypo/hachoir
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#148">[ date ]</a>
              <a href="thread.html#148">[ thread ]</a>
              <a href="subject.html#148">[ subject ]</a>
              <a href="author.html#148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: haypo
Date: 2005-10-31 17:40:26 +0100 (Mon, 31 Oct 2005)
New Revision: 241

Added:
   haypo/hachoir/ui_property.py
   haypo/hachoir/ui_window.py
Modified:
   haypo/hachoir/bmp_filter.xml
   haypo/hachoir/chunk.py
   haypo/hachoir/filter.py
   haypo/hachoir/hachoir.glade
   haypo/hachoir/hachoir_class.py
   haypo/hachoir/plugins/png.py
   haypo/hachoir/ui.py
   haypo/hachoir/ui_new_chunk.py
   haypo/hachoir/ui_popup.py
   haypo/hachoir/user_filter.py
Log:
An user filter is not just one level.


Modified: haypo/hachoir/bmp_filter.xml
===================================================================
--- haypo/hachoir/bmp_filter.xml	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/bmp_filter.xml	2005-10-31 16:40:26 UTC (rev 241)
@@ -1,5 +1,5 @@
 &lt;?xml version='1.0' encoding='UTF-8'?&gt;
-&lt;user_filter hachoir_version='2005-10-27'&gt;
+&lt;user_filter hachoir_version='2005-10-27' id='bmp_file' description='Bitmap picture file (BMP)'&gt;
   &lt;chunk format='!2s' id='header' description='Header (&quot;BM&quot;)'/&gt;
   &lt;chunk format='&lt;L' id='file_size' description='File size (bytes)'/&gt;
   &lt;chunk format='&lt;L' id='notused' description='Reseved'/&gt;
@@ -15,5 +15,4 @@
   &lt;chunk format='&lt;L' id='vertical_dpi' description='Vertical DPI'/&gt;
   &lt;chunk format='&lt;L' id='used_colors' description='Number of color used'/&gt;
   &lt;chunk format='&lt;L' id='important_color' description='Number of import colors'/&gt;
-  &lt;chunk format='!{@end@}s' id='image_data' description='Image data'/&gt;
 &lt;/user_filter&gt;

Modified: haypo/hachoir/chunk.py
===================================================================
--- haypo/hachoir/chunk.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/chunk.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -86,15 +86,22 @@
         return self._array[index]
         
 class FilterChunk(Chunk):
-    def __init__(self, id, description, stream, filter):
-        Chunk.__init__(self, id, description, stream, filter.getAddr(), filter.getSize(), filter)
+    def __init__(self, id, filter, parent):
+        Chunk.__init__(self, id, filter.description, filter.getStream(), filter.getAddr(), filter.getSize(), parent)
         self._filter = filter
+        self._filter.filter_chunk = self
 
     def update(self):
         filter_class = self._filter.__class__
         stream = self._filter.getStream()
+        parent = self._filter.getParent()
         stream.seek(self.addr)
-        self._filter = filter_class(stream, self._filter.getParent())
+        filter = filter_class(stream, parent)
+        self.setFilter(filter)
+
+    def setFilter(self, filter):
+        print &quot;Set filter to %s&quot; % filter.id
+        self._filter = filter
         self._filter.updateParent(self)
         
     def _getSize(self):

Modified: haypo/hachoir/filter.py
===================================================================
--- haypo/hachoir/filter.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/filter.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -11,7 +11,7 @@
 from format import splitFormat    
 
 class Filter:
-    def __init__(self, id, description, stream, parent=None):
+    def __init__(self, id, description, stream, parent):
         self.id = id
         self.description = description
         self._sub_struct = {}
@@ -24,6 +24,7 @@
             self.depth = 1
             self.table_item = None
             self.table_parent = None 
+        self.filter_chunk = None 
         self.indent = &quot; &quot; * ((self.depth-1)*2)
         self.child_indent = &quot; &quot; * (self.depth*2)
         self.table_item = None
@@ -66,7 +67,7 @@
         addr = prev_chunk.addr + prev_chunk.size
         chunk = FormatChunk(id, description, self.getStream(), addr, &quot;!%ss&quot; % size, self)
         chunk_pos = self._chunks.index(prev_chunk)+1
-        self._appendChunk(chunk, position=chunk_pos)
+        self._appendChunk(chunk, can_truncate=True, position=chunk_pos)
 
     def rescan(self, from_chunk, diff_size, new_id=None, new_description=None):
         if from_chunk != None:
@@ -141,26 +142,26 @@
             type = chunk.getFormat()
         elif issubclass(type, FilterChunk):
             type = chunk.getFilter().id
-        ui.ui.add_table(self.table_parent, chunk.addr, chunk.size, type, chunk.id, chunk.description, chunk.getDisplayData())
+        ui.window.add_table(self.table_parent, chunk.addr, chunk.size, type, chunk.id, chunk.description, chunk.getDisplayData())
 
     def redisplay(self):  
         self.display()
-
-    def display(self):  
-        # Update parent button
-        ui.ui.enableParentButton(self.getParent() != None)
-        
-        # Update status bar
+    
+    def updateStatusBar(self):
         text = &quot;&quot;
         current = self
         while current != None:
             if text != &quot;&quot;: text = &quot; &gt; &quot; + text
             text = current.id + text
             current = current.getParent()
-        ui.ui.updateStatusBar(&quot;%s: %s&quot; % (text, self.description))
+        ui.window.updateStatusBar(&quot;%s: %s&quot; % (text, self.description))
+
+    def display(self):  
+        ui.window.enableParentButton(self.getParent() != None)
+        self.updateStatusBar()
             
         # Update table
-        ui.ui.clear_table()
+        ui.window.clear_table()
         for chunk in self._chunks:
             if issubclass(chunk.__class__, ArrayChunk):
                 for subchunk in chunk:
@@ -228,7 +229,7 @@
 
     def readChild(self, id, filter_class, description): 
         filter = filter_class(self._stream, self)
-        chunk = FilterChunk(id, filter.description, self._stream, filter)
+        chunk = FilterChunk(id, filter, self)
         self._appendChunk(chunk)
         filter.updateParent(chunk)
         self._stream.seek(chunk.addr + chunk.size)
@@ -244,7 +245,7 @@
             filter = filter_class(self._stream, self)
             chunk_id = &quot;%s[%u]&quot; % (id, nb)
             nb = nb + 1
-            chunk = FilterChunk(chunk_id, filter.description, self._stream, filter)
+            chunk = FilterChunk(chunk_id, filter, self)
             array.append( chunk )
             last_filter = filter
 
@@ -265,6 +266,20 @@
         return &quot;Filter(%s) &lt;id=%s, description=%s&gt;&quot; % \
             (self.__class__, self.id, self.description)
 
+    def addNewFilter(self, chunk, id, size, desc):
+        chunk.setFormat(&quot;!%us&quot; % size, &quot;split&quot;, id, desc)
+
+        stream = self.getStream()
+        stream.seek(chunk.addr)
+        filter = Filter(id, desc, stream, self)
+        filter._appendChunk(chunk)
+        new_chunk = FilterChunk(chunk.id, filter, self)
+        pos = self._chunks.index(chunk)
+        self._chunks[pos] = new_chunk
+        self._chunks_dict[chunk.id] = new_chunk
+        self.redisplay()
+        return filter
+
     def getParent(self):
         return self._parent
 

Modified: haypo/hachoir/hachoir.glade
===================================================================
--- haypo/hachoir/hachoir.glade	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/hachoir.glade	2005-10-31 16:40:26 UTC (rev 241)
@@ -178,6 +178,21 @@
 		  &lt;property name=&quot;homogeneous&quot;&gt;True&lt;/property&gt;
 		&lt;/packing&gt;
 	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkToolButton&quot; id=&quot;toolbutton_property&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;stock_id&quot;&gt;gtk-properties&lt;/property&gt;
+		  &lt;property name=&quot;visible_horizontal&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;visible_vertical&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;is_important&quot;&gt;False&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_toolbutton_property&quot; last_modification_time=&quot;Mon, 31 Oct 2005 16:11:08 GMT&quot;/&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;homogeneous&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
 	    &lt;/widget&gt;
 	  &lt;/child&gt;
 	&lt;/widget&gt;
@@ -243,7 +258,7 @@
       &lt;signal name=&quot;activate&quot; handler=&quot;onNewChunk&quot; last_modification_time=&quot;Sun, 30 Oct 2005 23:08:19 GMT&quot;/&gt;
 
       &lt;child internal-child=&quot;image&quot;&gt;
-	&lt;widget class=&quot;GtkImage&quot; id=&quot;image3&quot;&gt;
+	&lt;widget class=&quot;GtkImage&quot; id=&quot;image5&quot;&gt;
 	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 	  &lt;property name=&quot;stock&quot;&gt;gtk-cut&lt;/property&gt;
 	  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -257,6 +272,27 @@
   &lt;/child&gt;
 
   &lt;child&gt;
+    &lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;new_filter1&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;New _filter&lt;/property&gt;
+      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+      &lt;signal name=&quot;activate&quot; handler=&quot;onNewFilter&quot; last_modification_time=&quot;Mon, 31 Oct 2005 06:42:27 GMT&quot;/&gt;
+
+      &lt;child internal-child=&quot;image&quot;&gt;
+	&lt;widget class=&quot;GtkImage&quot; id=&quot;image6&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;stock&quot;&gt;gtk-cut&lt;/property&gt;
+	  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
+	  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	&lt;/widget&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+
+  &lt;child&gt;
     &lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;join_chunks&quot;&gt;
       &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
       &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Join chunks&lt;/property&gt;
@@ -264,7 +300,7 @@
       &lt;signal name=&quot;activate&quot; handler=&quot;onJoinChunks&quot; last_modification_time=&quot;Sun, 30 Oct 2005 23:08:19 GMT&quot;/&gt;
 
       &lt;child internal-child=&quot;image&quot;&gt;
-	&lt;widget class=&quot;GtkImage&quot; id=&quot;image4&quot;&gt;
+	&lt;widget class=&quot;GtkImage&quot; id=&quot;image7&quot;&gt;
 	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 	  &lt;property name=&quot;stock&quot;&gt;gtk-go-up&lt;/property&gt;
 	  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -285,7 +321,7 @@
       &lt;signal name=&quot;activate&quot; handler=&quot;onSetFormat&quot; last_modification_time=&quot;Sun, 30 Oct 2005 23:27:49 GMT&quot;/&gt;
 
       &lt;child internal-child=&quot;image&quot;&gt;
-	&lt;widget class=&quot;GtkImage&quot; id=&quot;image5&quot;&gt;
+	&lt;widget class=&quot;GtkImage&quot; id=&quot;image8&quot;&gt;
 	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 	  &lt;property name=&quot;stock&quot;&gt;gtk-edit&lt;/property&gt;
 	  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -349,7 +385,6 @@
 	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
 	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
 	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
-	      &lt;signal name=&quot;released&quot; handler=&quot;gtk_widget_hide&quot; after=&quot;yes&quot; last_modification_time=&quot;Mon, 31 Oct 2005 01:42:37 GMT&quot;/&gt;
 	    &lt;/widget&gt;
 	  &lt;/child&gt;
 
@@ -363,7 +398,6 @@
 	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
 	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
 	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
-	      &lt;signal name=&quot;released&quot; handler=&quot;gtk_widget_hide&quot; last_modification_time=&quot;Mon, 31 Oct 2005 01:42:47 GMT&quot;/&gt;
 	    &lt;/widget&gt;
 	  &lt;/child&gt;
 	&lt;/widget&gt;
@@ -663,4 +697,444 @@
   &lt;/child&gt;
 &lt;/widget&gt;
 
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;new_filter&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;New filter&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox2&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area2&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelbutton2&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okbutton2&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox3&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label9&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;New filter options&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;6&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkTable&quot; id=&quot;table2&quot;&gt;
+	      &lt;property name=&quot;border_width&quot;&gt;6&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;n_rows&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;n_columns&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;row_spacing&quot;&gt;6&lt;/property&gt;
+	      &lt;property name=&quot;column_spacing&quot;&gt;6&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label10&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Id:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label11&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Description:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry1&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry2&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label12&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Type:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+		  &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+		  &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkComboBoxEntry&quot; id=&quot;comboboxentry1&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;filter_property&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Filter property&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox3&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area3&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelbutton3&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okbutton3&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkTable&quot; id=&quot;table3&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;n_rows&quot;&gt;2&lt;/property&gt;
+	  &lt;property name=&quot;n_columns&quot;&gt;2&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;row_spacing&quot;&gt;6&lt;/property&gt;
+	  &lt;property name=&quot;column_spacing&quot;&gt;6&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label13&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Id:&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label14&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Description:&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkEntry&quot; id=&quot;id&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+	      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+	      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkEntry&quot; id=&quot;description&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+	      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+	      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
 &lt;/glade-interface&gt;

Modified: haypo/hachoir/hachoir_class.py
===================================================================
--- haypo/hachoir/hachoir_class.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/hachoir_class.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -20,18 +20,25 @@
     def onRowClick(self, chunk_id):
         if chunk_id == None: return
         chunk = self.filter.getChunk(chunk_id)
+        print &quot;Click: %s&quot; % chunk
         if issubclass(chunk.__class__, FilterChunk):
             self.filter = chunk.getFilter()
             self.filter.display()
 
     def loadUser(self, filename):
-        stream = self.main_filter.getStream()
+        old_filter = self.filter
+        user = UserFilterDescriptor(xml_file=filename)
+        stream = self.filter.getStream()
         stream.seek(0)
-        user = UserFilterDescriptor(xml_file=filename)
-        self.filter = UserFilter(user, stream)
-        self.main_filter = self.filter
+        parent = self.filter.getParent()
+        self.filter = UserFilter(user, stream, parent)
+        if parent == None:
+            self.main_filter = self.filter
+        else:
+            chunk = old_filter.filter_chunk
+            chunk.setFilter(self.filter)
         self.filter.display()
-        self.ui.updateToolbar()
+        self.ui.window.updateToolbar()
     
     def saveUser(self, filename):
         my = UserFilterDescriptor(filter=self.main_filter)
@@ -61,7 +68,7 @@
         if self.display:
             print &quot;=== File %s data ===&quot; % filename
             display_func(self.filter)
-        self.ui.updateToolbar()
+        self.ui.window.updateToolbar()
 
     def run(self, filename):
         if filename != None:

Modified: haypo/hachoir/plugins/png.py
===================================================================
--- haypo/hachoir/plugins/png.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/plugins/png.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -96,7 +96,7 @@
     &quot;&quot;&quot;
 
     def __init__(self, stream):
-        Filter.__init__(self, &quot;png_file&quot;, &quot;PNG file&quot;, stream)
+        Filter.__init__(self, &quot;png_file&quot;, &quot;PNG file&quot;, stream, None)
         self.read(&quot;header&quot;, &quot;!8s&quot;, &quot;File header&quot;)
         assert self.header == &quot;\x89\x50\x4E\x47\x0D\x0A\x1A\x0A&quot;
         self.readArray(&quot;chunks&quot;, PngChunk, &quot;Png chunks&quot;, self.checkEndOfChunks)

Modified: haypo/hachoir/ui.py
===================================================================
--- haypo/hachoir/ui.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/ui.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -4,11 +4,15 @@
 import gtk
 import gtk.glade
 from ui_popup import TablePopup
+from ui_window import MainWindow
+from ui_property import PropertyDialog
 
 def loadInterface(hachoir):
     global ui 
+    global window
     glade = os.path.join(os.path.dirname(__file__), 'hachoir.glade')
     ui = GladeInterface(glade, hachoir)
+    window = ui.window
     hachoir.ui = ui 
     hachoir.ui.on_row_click = hachoir.onRowClick
     hachoir.ui.on_go_parent = hachoir.onGoParent
@@ -19,163 +23,29 @@
         self.glade_xml = filename
         self.on_row_click = None # event(chunk_id)
         self.on_go_parent = None # event(chunk_id)
-        self.about_dialog = None
         self.build_ui()
-
-    def getTableChunk(self, col):
-        chunk_id = self.table_store[col][3]
-        if chunk_id == None: return None
-        return self.hachoir.filter.getChunk(chunk_id)
-
-    def on_treeview_button_press_event(self, treeview, event):
-        if event.button == 3:
-            x = int(event.x)
-            y = int(event.y)
-            time = event.time
-            pthinfo = treeview.get_path_at_pos(x, y)
-            if pthinfo != None:
-                path, col, cellx, celly = pthinfo
-                treeview.grab_focus()
-                treeview.set_cursor( path, col, 0)
-                self.table_popup.show(pthinfo, event)
-            return 1
         
-    def updateToolbar(self):
-        self.toolbutton_open.set_sensitive(self.hachoir.main_filter != None)
-        self.toolbutton_save.set_sensitive(self.hachoir.main_filter != None)
-        if self.hachoir.main_filter == None:
-            self.toolbutton_parent.set_sensitive(False)
-
     def run(self):
-        self.updateToolbar()
+        self.window.updateToolbar()
         try:
             gtk.main()
         except KeyboardInterrupt:
             print &quot;Interrupted (CTRL+C).&quot;
 
-    def updateStatusBar(self, text):
-        self.statusbar.push(self.statusbar_state, text)
+    def loadAbout(self):
+        xml = gtk.glade.XML(self.glade_xml, &quot;about_dialog&quot;)
+        self.about_dialog = xml.get_widget('about_dialog')
+        self.about_dialog.hide()
         
-    def enableParentButton(self, enable):
-        self.toolbutton_parent.set_sensitive(enable)
-
-    def clear_table(self):
-        self.table_store.clear()
-
-    def set_table_value(self, iter, column, value):
-        row = self.table_store[iter]
-        row[column] = value
-       
-    def add_table_child(self, parent, addr, size, format, id, description):
-        return self.table_store.append(parent, (addr, format, size, None, id, description, None,))
-       
-    def add_table(self, parent, addr, size, format, id, description, value):
-        self.table_store.append(parent, (addr, format, size, id, value, description, ))
-       
-    def load_window (self):
-        xml = gtk.glade.XML(self.glade_xml, &quot;main_window&quot;)
-        self.window = xml.get_widget('main_window')
-        self.statusbar = xml.get_widget('statusbar')
-        self.toolbar = xml.get_widget('toolbar')
-        self.toolbutton_parent = xml.get_widget('toolbutton_parent')
-        self.toolbutton_new = xml.get_widget('toolbutton_new')
-        self.toolbutton_open = xml.get_widget('toolbutton_open')
-        self.toolbutton_save = xml.get_widget('toolbutton_save')
-        self.statusbar_state = self.statusbar.get_context_id(&quot;State&quot;)
-        self.table = xml.get_widget('table')
-        self.table_store = None
-        xml.signal_autoconnect(self)
-        
     def build_ui(self):
-        self.load_window()
+        self.window = MainWindow(self)
+        self.loadAbout()
         self.table_popup = TablePopup(self, self.glade_xml)
-        self.window.connect(&quot;key-press-event&quot;, self.onKeyUp)
-        self.table.connect(&quot;button_press_event&quot;, self.on_treeview_button_press_event)
-        self.window.set_size_request(760,300)
-        self.build_table()
-
-    def onKeyUp(self, widget, key, data=None):
-        if key.keyval == gtk.keysyms.Escape:
-            self.on_go_parent()
+        self.property_dialog = PropertyDialog(self)
         
-    def onTableClicked(self, widget, iter, data=None):
-        row = self.table_store[iter]
-        self.on_row_click(row[3])
-
-    def build_table(self):
-        self.table_store = gtk.TreeStore(str, str, int, str, str, str)
-        self.table.set_model(self.table_store)
-        self.table.connect(&quot;row-activated&quot;, self.onTableClicked)
-        self.treeview_add_column(self.table, &quot;Address&quot;, 0)
-        self.treeview_add_column(self.table, &quot;Format&quot;, 1)
-        self.treeview_add_column(self.table, &quot;Size&quot;, 2)
-        self.treeview_add_column(self.table, &quot;Name&quot;, 3)
-        self.treeview_add_column(self.table, &quot;Value&quot;, 4)
-        self.treeview_add_column(self.table, &quot;Description&quot;, 5)
-        self.table.set_reorderable(True)
-        self.treeselection = self.table.get_selection()
-
-    def treeview_add_column(self, treeview, name, num):
-        col = gtk.TreeViewColumn(name)
-        treeview.append_column(col)
-        cell = gtk.CellRendererText()
-        col.pack_start(cell, True)
-        col.add_attribute(cell, 'text', num)
-        treeview.set_search_column(num)
-        col.set_sort_column_id(num)
- 
-    def on_toolbutton_parent(self, widget, data=None):
-        self.on_go_parent()
-
-    def on_toolbutton_new(self, widget):
-        self.on_open_activate(widget)
-        
-    def on_open_activate(self, widget):
-        chooser = gtk.FileChooserDialog( \
-            title=&quot;Choose file to split&quot;,
-            action=gtk.FILE_CHOOSER_ACTION_OPEN,
-            buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_OPEN,gtk.RESPONSE_OK))
-        if chooser.run() == gtk.RESPONSE_OK:
-            filename = chooser.get_filename() 
-            self.hachoir.load(filename)
-        chooser.destroy()
-
-    def on_toolbutton_open(self, widget):
-        chooser = gtk.FileChooserDialog( \
-            title=&quot;Choose filter&quot;,
-            action=gtk.FILE_CHOOSER_ACTION_OPEN,
-            buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_OPEN,gtk.RESPONSE_OK))
-        if chooser.run() == gtk.RESPONSE_OK:
-            filename = chooser.get_filename() 
-            print &quot;TODO: Load %s&quot; % filename
-            self.hachoir.loadUser(filename)
-        chooser.destroy()
-
-    def on_toolbutton_save(self, widget):
-        print &quot;Save&quot;
-        chooser = gtk.FileChooserDialog( \
-            title=&quot;Save filter into ...&quot;,
-            action=gtk.FILE_CHOOSER_ACTION_SAVE,
-            buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_SAVE,gtk.RESPONSE_OK))
-        if chooser.run() == gtk.RESPONSE_OK:
-            filename = chooser.get_filename() 
-            self.hachoir.saveUser(filename)
-        chooser.destroy()
-
-    def on_about_activate(self, widget):
-        if self.about_dialog == None:
-            self.about_xml = gtk.glade.XML(self.glade_xml, &quot;about_dialog&quot;)
-            self.about_dialog = self.about_xml.get_widget('about_dialog')
-        self.about_dialog.show()
-
-    def on_quit_activate(self, widget):
-        self.quit()
-
-    def on_window_destroy(self, widget, data=None):
-        self.quit()
-
     def quit(self):
         print &quot;Quit.&quot;
         gtk.main_quit()
 
 ui = None
+window = None

Modified: haypo/hachoir/ui_new_chunk.py
===================================================================
--- haypo/hachoir/ui_new_chunk.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/ui_new_chunk.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -16,7 +16,6 @@
         self.format_widget = xml.get_widget(&quot;format&quot;)
         self.id_widget = xml.get_widget(&quot;identifier&quot;)
         self.desc_widget = xml.get_widget(&quot;description&quot;)
-        self.response = gtk.RESPONSE_CANCEL
 
     def getId(self):
         return self.id_widget.get_text()

Modified: haypo/hachoir/ui_popup.py
===================================================================
--- haypo/hachoir/ui_popup.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/ui_popup.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -4,6 +4,7 @@
 import gtk.glade
 from chunk import FormatChunk
 from ui_new_chunk import NewChunkDialog
+from format import splitFormat # TODO: remove this line
 
 class TablePopup:
     def __init__(self, ui, filename):
@@ -16,7 +17,7 @@
 
     def show(self, path_info, event):
         col = path_info[0][0]
-        self.chunk = self.ui.getTableChunk(col)
+        self.chunk = self.ui.window.getTableChunk(col)
         if self.chunk == None:
             print &quot;Can't get chunk&quot;
             return
@@ -30,6 +31,16 @@
         desc = self.new_chunk.getDescription()
         self.chunk.setFormat(format, &quot;split&quot;, id, desc)
 
+    def onNewFilter(self, event):
+        if self.new_chunk.runNewChunk() == gtk.RESPONSE_CANCEL: return
+        assert issubclass(self.chunk.__class__, FormatChunk) and self.chunk.isString()
+        format = self.new_chunk.getFormat()
+        split_format = splitFormat(format)
+        size = int(split_format[1])
+        id = self.new_chunk.getId()
+        desc = self.new_chunk.getDescription()
+        self.chunk.getParent().addNewFilter(self.chunk, id, size, desc)
+
     def onSetFormat(self, event):
         if issubclass(self.chunk.__class__, FormatChunk):
             if self.new_chunk.runSetFormat(self.chunk) == gtk.RESPONSE_CANCEL: return

Added: haypo/hachoir/ui_property.py
===================================================================
--- haypo/hachoir/ui_property.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/ui_property.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -0,0 +1,28 @@
+import pygtk
+pygtk.require ('2.0')
+import gtk
+import gtk.glade
+from format import splitFormat
+
+class PropertyDialog:
+    def __init__(self, ui):
+        self.ui = ui
+        xml = gtk.glade.XML(self.ui.glade_xml, &quot;filter_property&quot;)
+        self.window = xml.get_widget(&quot;filter_property&quot;)
+        self.window.hide()
+        xml.signal_autoconnect(self)
+        self.id_widget = xml.get_widget(&quot;id&quot;)
+        self.desc_widget = xml.get_widget(&quot;description&quot;)
+
+    def getId(self):
+        return self.id_widget.get_text()
+
+    def getDescription(self):
+        return self.desc_widget.get_text()
+
+    def run(self, filter):
+        self.id_widget.set_text(filter.id)
+        self.desc_widget.set_text(filter.description)
+        r = self.window.run()
+        self.window.hide()
+        return r

Added: haypo/hachoir/ui_window.py
===================================================================
--- haypo/hachoir/ui_window.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/ui_window.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -0,0 +1,156 @@
+import os
+import pygtk
+pygtk.require ('2.0')
+import gtk
+import gtk.glade
+
+class MainWindow:
+    def __init__(self, ui):
+        self.ui = ui
+        xml = gtk.glade.XML(self.ui.glade_xml, &quot;main_window&quot;)
+        self.window = xml.get_widget('main_window')
+        self.statusbar = xml.get_widget('statusbar')
+        self.toolbar = xml.get_widget('toolbar')
+        self.toolbutton_parent = xml.get_widget('toolbutton_parent')
+        self.toolbutton_new = xml.get_widget('toolbutton_new')
+        self.toolbutton_open = xml.get_widget('toolbutton_open')
+        self.toolbutton_save = xml.get_widget('toolbutton_save')
+        self.toolbutton_property = xml.get_widget('toolbutton_property')
+        self.statusbar_state = self.statusbar.get_context_id(&quot;State&quot;)
+        self.table = xml.get_widget('table')
+        self.table_store = None
+        xml.signal_autoconnect(self)
+        self.window.connect(&quot;key-press-event&quot;, self.onKeyUp)
+        self.table.connect(&quot;button_press_event&quot;, self.on_treeview_button_press_event)
+        self.window.set_size_request(760,300)
+        self.build_table()
+        
+    def updateToolbar(self):
+        file_present = (self.ui.hachoir.main_filter != None)
+        self.toolbutton_open.set_sensitive(file_present)
+        self.toolbutton_save.set_sensitive(file_present)
+        if not file_present:
+            self.toolbutton_parent.set_sensitive(False)
+        self.toolbutton_property.set_sensitive(file_present)
+
+    def getTableChunk(self, col):
+        chunk_id = self.table_store[col][3]
+        if chunk_id == None: return None
+        return self.ui.hachoir.filter.getChunk(chunk_id)
+
+    def on_treeview_button_press_event(self, treeview, event):
+        if event.button == 3:
+            x = int(event.x)
+            y = int(event.y)
+            time = event.time
+            pthinfo = treeview.get_path_at_pos(x, y)
+            if pthinfo != None:
+                path, col, cellx, celly = pthinfo
+                treeview.grab_focus()
+                treeview.set_cursor( path, col, 0)
+                self.ui.table_popup.show(pthinfo, event)
+            return 1
+
+    def updateStatusBar(self, text):
+        self.statusbar.push(self.statusbar_state, text)
+        
+    def enableParentButton(self, enable):
+        self.toolbutton_parent.set_sensitive(enable)
+
+    def clear_table(self):
+        self.table_store.clear()
+
+    def set_table_value(self, iter, column, value):
+        row = self.table_store[iter]
+        row[column] = value
+       
+    def add_table_child(self, parent, addr, size, format, id, description):
+        return self.table_store.append(parent, (addr, format, size, None, id, description, None,))
+       
+    def add_table(self, parent, addr, size, format, id, description, value):
+        self.table_store.append(parent, (addr, format, size, id, value, description, ))
+
+    def onKeyUp(self, widget, key, data=None):
+        if key.keyval == gtk.keysyms.Escape:
+            self.on_go_parent()
+        
+    def onTableClicked(self, widget, iter, data=None):
+        row = self.table_store[iter]
+        self.ui.on_row_click(row[3])
+
+    def build_table(self):
+        self.table_store = gtk.TreeStore(str, str, int, str, str, str)
+        self.table.set_model(self.table_store)
+        self.table.connect(&quot;row-activated&quot;, self.onTableClicked)
+        self.treeview_add_column(self.table, &quot;Address&quot;, 0)
+        self.treeview_add_column(self.table, &quot;Format&quot;, 1)
+        self.treeview_add_column(self.table, &quot;Size&quot;, 2)
+        self.treeview_add_column(self.table, &quot;Name&quot;, 3)
+        self.treeview_add_column(self.table, &quot;Value&quot;, 4)
+        self.treeview_add_column(self.table, &quot;Description&quot;, 5)
+        self.table.set_reorderable(True)
+        self.treeselection = self.table.get_selection()
+
+    def treeview_add_column(self, treeview, name, num):
+        col = gtk.TreeViewColumn(name)
+        treeview.append_column(col)
+        cell = gtk.CellRendererText()
+        col.pack_start(cell, True)
+        col.add_attribute(cell, 'text', num)
+        treeview.set_search_column(num)
+        col.set_sort_column_id(num)
+ 
+    def on_toolbutton_parent(self, widget, data=None):
+        self.ui.on_go_parent()
+
+    def on_toolbutton_new(self, widget):
+        self.on_open_activate(widget)
+
+    def on_toolbutton_property(self, widget):
+        print &quot;Property&quot;
+        filter = self.ui.hachoir.filter
+        dlg = self.ui.property_dialog
+        if dlg.run(filter) == gtk.RESPONSE_CANCEL: return
+        filter.id = dlg.getId() 
+        filter.description = dlg.getDescription()
+        filter.updateStatusBar()
+        
+    def on_open_activate(self, widget):
+        chooser = gtk.FileChooserDialog( \
+            title=&quot;Choose file to split&quot;,
+            action=gtk.FILE_CHOOSER_ACTION_OPEN,
+            buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_OPEN,gtk.RESPONSE_OK))
+        if chooser.run() == gtk.RESPONSE_OK:
+            filename = chooser.get_filename() 
+            self.ui.hachoir.load(filename)
+        chooser.destroy()
+
+    def on_toolbutton_open(self, widget):
+        chooser = gtk.FileChooserDialog( \
+            title=&quot;Choose filter&quot;,
+            action=gtk.FILE_CHOOSER_ACTION_OPEN,
+            buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_OPEN,gtk.RESPONSE_OK))
+        if chooser.run() == gtk.RESPONSE_OK:
+            filename = chooser.get_filename() 
+            self.ui.hachoir.loadUser(filename)
+        chooser.destroy()
+
+    def on_toolbutton_save(self, widget):
+        print &quot;Save&quot;
+        chooser = gtk.FileChooserDialog( \
+            title=&quot;Save filter into ...&quot;,
+            action=gtk.FILE_CHOOSER_ACTION_SAVE,
+            buttons=(gtk.STOCK_CANCEL,gtk.RESPONSE_CANCEL,gtk.STOCK_SAVE,gtk.RESPONSE_OK))
+        if chooser.run() == gtk.RESPONSE_OK:
+            filename = chooser.get_filename() 
+            self.ui.hachoir.saveUser(filename)
+        chooser.destroy()
+
+    def on_about_activate(self, widget):
+        self.about_dialog.show()
+
+    def on_quit_activate(self, widget):
+        self.ui.quit()
+
+    def on_window_destroy(self, widget, data=None):
+        self.ui.quit()

Modified: haypo/hachoir/user_filter.py
===================================================================
--- haypo/hachoir/user_filter.py	2005-10-31 06:28:38 UTC (rev 240)
+++ haypo/hachoir/user_filter.py	2005-10-31 16:40:26 UTC (rev 241)
@@ -21,9 +21,9 @@
         self.sub_format = sub_format
 
 class UserFilter(Filter):
-    def __init__(self, descriptor, stream):
-        Filter.__init__(self, &quot;user_filter&quot;, &quot;User filter&quot;, stream)
-        for chunk in descriptor.chunks:
+    def __init__(self, desc, stream, parent):
+        Filter.__init__(self, desc.id, desc.description, stream, parent)
+        for chunk in desc.chunks:
             if chunk.format == &quot;sub&quot;:
                 modules = chunk.sub_format.split('.')
                 chunk_class = modules[-1]
@@ -41,6 +41,9 @@
             self.createFromFilter(filter)
         elif xml_file != None:
             self.createFromXML(xml_file)
+        else:
+            self.id = None 
+            self.description = None 
             
     def writeIntoXML(self, filename):
         file = open(filename, &quot;w&quot;)
@@ -50,7 +53,10 @@
     def createFromXML(self, filename):
         xml = parse(filename)
         self.chunks = []
-        self.__loadXML(xml.documentElement)
+        root = xml.documentElement
+        self.id = root.getAttribute(&quot;id&quot;)
+        self.description = root.getAttribute(&quot;description&quot;)
+        self.__loadXML(root)
         
     def __loadXML(self, node):
         for chunk in node.childNodes:
@@ -73,6 +79,8 @@
         doc = impl.createDocument(None, &quot;user_filter&quot;, None)
         root = doc.documentElement
         root.setAttribute(&quot;hachoir_version&quot;, VERSION)
+        root.setAttribute(&quot;id&quot;, self.id)
+        root.setAttribute(&quot;description&quot;, self.id)
         self.__toXML(doc, root)
         return doc
 
@@ -85,9 +93,11 @@
             node.appendChild(item)
             if issubclass(chunk.__class__, UserSubChunk):
                 item.setAttribute(&quot;sub_format&quot;, chunk.sub_format)
-                chunk.sub.__toXML(doc, item)
+#                chunk.sub.__toXML(doc, item)
 
     def createFromFilter(self, filter):
+        self.id = filter.id 
+        self.description = filter.description
         self.chunks = []
         self.__createFromChunks(filter.getChunks())
 
@@ -98,7 +108,8 @@
             else:
                 if issubclass(chunk.__class__, FilterChunk):
                     format = str(chunk.getFilter().__class__)
-                    sub = UserFilterDescriptor(filter=chunk.getFilter())
+                    #sub = UserFilterDescriptor(filter=chunk.getFilter())
+                    sub = None
                     user = UserSubChunk(chunk.id, sub, format, chunk.description)
                 else:
                     user = UserChunk(chunk.id, chunk.getFormat(), chunk.description)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000147.html">[Happyboom-svn] r240 - haypo/hachoir
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#148">[ date ]</a>
              <a href="thread.html#148">[ thread ]</a>
              <a href="subject.html#148">[ subject ]</a>
              <a href="author.html#148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/happyboom-svn">More information about the Happyboom-svn
mailing list</a><br>
</body></html>
